<!doctype html>
<html>
<head>
<title>Imgur Image App</title>

<meta charset="utf-8" />
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="app.css">
</head>

<body>
<main>
<!--<h1>Imgur Image App</h1>-->
<p>
<input type="file" id="input-file" accept="image/*" onchange="previewFile()">
</p>

<p>
<img src="placeholder.png" alt="Placeholder" width="1" id="placeholder" hidden>
<canvas id="preview" width="1024" height="1024" title="Preview"></canvas>
</p>
  
<p class="urlbtn"><a href="" class="urllink" id="url"></a></p>

<p>
<button onclick="selectFile()"><i class="fa fa-upload"></i> Pilih File</button>
<a href="" class="btn" download="avatar.png" id="dl"><i class="fa fa-download"></i> Download</a>
</p>

<footer><p>Ferry Ayunda</p></footer>
</main>

<script src="app.js"></script>
<script src="imgur.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.7/axios.min.js"></script>
<script>
var copyUrlBtn = document.querySelector('.urlbtn');  
copyUrlBtn.addEventListener('click', function(event) {  
// Select the email link anchor text  
var urlLink = document.querySelector('.urllink');  
var range = document.createRange();  
range.selectNode(urlLink);  
window.getSelection().addRange(range);  

try {  
// Now that we've selected the anchor text, execute the copy command  
var successful = document.execCommand('copy');  
var msg = successful ? 'successful' : 'unsuccessful';  
alert('Copy url imgur command was ' + msg);  
} catch(err) {  
alert('Oops, unable to copy');  
}  

// Remove the selections - NOTE: Should use
// removeRange(range) when it is supported  
window.getSelection().removeAllRanges();  
});
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/camanjs/4.1.2/caman.full.pack.js"></script>
<script>
var theCanvas;

function previewFile() {
var preview = document.querySelector(".preview");
var file = document.querySelector('input[type=file]').files[0];
var reader = new FileReader();

reader.addEventListener("load", function() {
preview.src = reader.result;
}, false);

if (file) {
reader.readAsDataURL(file)
theCanvas = Caman('.preview')
}
}

var filters = document.querySelectorAll('.filter')

Array.from(filters).forEach(function(node) {
node.addEventListener('click', function(e) {
if (typeof theCanvas === 'undefined') return;
    
var button = e.target,
filter = button.dataset.filter,
filterName = button.textContent;
    
button.textContent = 'Processing...';
    
theCanvas.reset();
theCanvas[filter]();
    
return theCanvas.render(function () {
button.textContent = filterName
});
})
})
</script>
</body>
</html>
